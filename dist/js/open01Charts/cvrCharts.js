function cvrBtn(){function e(e){var a=[];void 0!=xhr&&xhr.abort();for(var n=0;n<cvrUrlData.length;n++)a.push(cvrUrlData[n].url);"cvrTime"==e?urlCmd="?cmd=WEL:GETPV":"cvrAddres"==e?urlCmd="?cmd=WEL:GETGE":"cvrBrowser"==e?urlCmd="?cmd=WEL:GETBROWSER":"cvrOs"==e&&(urlCmd="?cmd=WEL:GETOS"),void 0!=xhr&&xhr.abort(),xhr=$.ajax({type:"get",url:btnUrl+urlCmd+t,async:!0,cache:!0,data:{project_id:projectID,urls:a,startTime:startTime,endTime:endTime,country:r,timeZone:timeZone},success:function(t){hideLoading(),$(".echarts_funnel").css({height:"60%"}),$(".echarts_more").css({height:"39%"}),funnelChart.resize(),"cvrTime"==e?cvrLine(t):"cvrAddres"==e?cvrMap(t):"cvrBrowser"==e?cvrBr(t):"cvrOs"==e&&cvrOs(t)},error:function(){}})}btnUrl="/api/conversion.open",moreDateMark=0,pageName="CVR";var t="";""!=localStorage.getItem("ANALYSISINTERVAL")&&null!=localStorage.getItem("ANALYSISINTERVAL"),t="HOUR";var a,r;chartTxt=[Dynamic.analysis_cvr_steps,"URL1","URL2",Dynamic.analysis_cvr];$("#addChart").removeClass(),$("#addChart").addClass("btn default disabled"),$(".general").empty();var n=Dynamic.analysis_cvr_paginationArr;swiper&&swiper.destroy(!1),swiper=new Swiper(".swiper-container",{observer:!0,observeParents:!0,pagination:".swiper-pagination",paginationClickable:!0,paginationBulletRender:function(e,t){return'<li class="'+t+' swiperContainer col-md-12 col-xs-12" style="text-align:left;border-color:transparent !important;">'+n[e]+"</li>"}}),void 0!=xhr&&xhr.abort(),$("#selectMapType").selectpicker({width:"auto",size:10,title:function(){for(var e=0;e<$("#selectMapType option").length;e++)$("#selectMapType option").eq(e).val()==r&&$("#selectMapType option").eq(e).attr("selected","selected");return r=mapType,$("#selectMapType option").eq(e).attr("selected","selected").text()}()}),$("#selectMapType").on("change",function(){r=$("#selectMapType option:selected").val()}),$(".box2").show(),loadcharts=echarts.init(document.getElementById("loadbox")),loadcharts.showLoading({text:"loading",color:"#678098",textColor:"#678098",maskColor:"rgba(255, 255, 255, 0.8)",zlevel:0}),xhr=$.ajax({type:"get",url:"/api/conversion.open?cmd=WEL:GETCVRINFO",data:{startTime:startTime,endTime:endTime,project_id:projectID,timeZone:timeZone},async:!0,success:function(e){if(cvrMoreData=e,loadcharts.hideLoading(),$(".box2").hide(),e.length>0&&"string"!=typeof e){cvrUrlData=e;for(var t=[],a=[],r=[],n=0;n<e.length;n++)a.push(e[n].url),t.push(e[n].desc),r.push(e[n].pvCount);if($(".cvrBox_line4").css("display","block"),$(".cvrBox_line3").css("display","none"),$(".cvrBox_line2").css("display","none"),$(".echarts_funnel").css({height:"100%"}),$(".echarts_more").css({height:"0%"}),$(".echarts_more").empty(),document.getElementsByClassName("echarts_funnel")[0]){for(var o=[],i=[],n=0;n<t.length;n++){var l={};if(0!=r[n-1]){l.value=r[n];toDecimal2(ForDight(100*r[n]/r[n-1],4));l.name=t[n]}else{l.value="∞";l.name=t[n]}0!=n&&i.push(ForDight(r[n]/r[n-1],4)),o.push(l)}op01Funnel(o)}}else $(".cvrBox_line4").css("display","none"),$(".cvrBox_line3").css("display","none"),$(".cvrBox_line2").css("display","block")},error:function(){}}),$("#optionCvr").unbind("click"),$("#optionCvr").click(function(){0==projectID&&"0"!==localStorage.getItem("LINK_STATUS")?swal({title:analysis_cvr_text0,type:"error",confirmButtonText:analysis_ok,closeOnConfirm:!1}):($(".cvrBox_line2").css("display","none"),$(".cvrBox_line3").css("display","block"))}),$(".cvrAddBtn").unbind("click"),$(".cvrAddBtn").on("click",function(){if($(".cvrBox_line3 table tr").length<14){var e=$(".cvrBox_line3 table tr:last-child td:nth-child(1) span").text();$(".cvrBox_line3 table tbody").append("<tr>            \t\t\t\t<td>"+Dynamic.analysis_cvr_steps+"<span>"+(parseInt(e)+1)+'</span></td>            \t\t\t\t<td><input type="text" name="cvrText1" id="cvrText1" value="" placeholder="'+Dynamic.analysis_cvr_placeholder1+'"/></td>            \t\t\t\t<td><input type="url" name="cvrText1" id="cvrText1" value="" placeholder="'+Dynamic.analysis_cvr_placeholder2+'"/></td>            \t\t\t</tr>')}}),$(".cvrRemoveBtn").unbind("click"),$(".cvrRemoveBtn").on("click",function(){$(".cvrBox_line3 table tr").length>3&&$(".cvrBox_line3 table tbody tr:last-child").remove()}),$(".cvrBack").unbind("click"),$(".cvrBack").on("click",function(){$(".cvrDataTable tr").not("tr:eq(0)").remove();for(var e=0;e<cvrUrlData.length;e++)$(".cvrDataTable").append("<tr>    \t\t\t\t<td>"+Dynamic.analysis_cvr_steps+"<span>"+(parseInt(e)+1)+'</span></td>    \t\t\t\t<td><input type="text" name="cvrText1" id="cvrText1" value="'+cvrUrlData[e].desc+'" placeholder="'+Dynamic.analysis_cvr_placeholder1+'"/></td>    \t\t\t\t<td><input type="url" name="cvrText1" id="cvrText1" value="'+cvrUrlData[e].url+'" placeholder="'+Dynamic.analysis_cvr_placeholder2+'"/></td>    \t\t\t</tr>');$(".cvrBox_line4").css("display","none"),$(".cvrBox_line3").css("display","block")}),$(".cvrSaveBtn").click(function(){function e(){for(var e=0;e<$(".cvrBox_line3 input").length;e++)if(""==$(".cvrBox_line3 input").eq(e).val())return!1}for(var t=[],a=[],r=0;r<$(".cvrBox_line3 table tr").length-1;r++)t.push($(".cvrBox_line3 table tr:eq("+(r+1)+") td:nth-child(2) input").val()),a.push($(".cvrBox_line3 table tr:eq("+(r+1)+") td:nth-child(3) input").val());0!=e()?(void 0!=xhr&&xhr.abort(),xhr=$.ajax({type:"get",url:btnUrl+"?cmd=WEL:INSERTCVRINFO",async:!0,cache:!0,data:{project_id:projectID,desc:t,url:a},dataType:"json",success:function(e){xhr=$.ajax({type:"get",url:"/api/conversion.open?cmd=WEL:GETCVRINFO",data:{startTime:startTime,endTime:endTime,project_id:projectID,timeZone:timeZone},async:!0,success:function(e){cvrMoreData=e,swal({title:Dynamic.manage_sl_savasuccess,text:"",confirmButtonText:Dynamic.upload_ok,type:"success"}),cvrUrlData=e;var t=[],a=[],r=[];$(".cvrBox_line3").css("display","none"),$(".cvrBox_line4").css("display","block");for(var n=0;n<e.length;n++)a.push(e[n].url),t.push(e[n].desc),r.push(e[n].pvCount);if(document.getElementsByClassName("echarts_funnel")[0]){for(var o=[],i=[],n=0;n<t.length;n++){var l={};if(0!=r[n-1]){l.value=r[n];toDecimal2(ForDight(100*r[n]/r[n-1],4));l.name=t[n]}else{l.value="∞";l.name=t[n]}0!=n&&i.push(ForDight(r[n]/r[n-1],4)),o.push(l)}op01Funnel(o)}}})},error:function(){}})):swal({title:Dynamic.analysis_cvr_text3,confirmButtonText:Dynamic.upload_ok,type:"error"})}),$(".cvrTime").click(function(){showLoading(),a="cvrTime",e(a)}),$(".cvrAddres").click(function(){showLoading(),a="cvrAddres",e(a)}),$(".cvrBrowser").click(function(){showLoading(),a="cvrBrowser",e(a)}),$(".cvrOs").click(function(){showLoading(),a="cvrOs",e(a)})}function op01Funnel(e){0!=toDecimal2(ForDight(100*e[e.length-1].value/e[0].value,2))?$(".cvrCount").html(toDecimal2(ForDight(100*e[e.length-1].value/e[0].value,2))+"%"):$(".cvrCount").html("0%"),hideLoading();for(var t=0,a=0;a<e.length;a++)e[a].value>t&&(t=e[a].value);funnelChart=echarts.init(document.getElementsByClassName("echarts_funnel")[0]);var r={title:{show:!1,text:Dynamic.analysis_cvr_paginationArr[0],subtext:"areaDemo",left:"center",textStyle:{color:"#999999"}},color:["#67809f","#4b77be","#4c87b9","#5e738b","#5c9bd1"],tooltip:{trigger:"item",formatter:"{b}<br/>"+Dynamic.analysis_pageViewNum+"：{c}"},toolbox:{show:!0,right:"10%",top:"20%",iconStyle:{normal:{borderColor:"#999999"},emphasis:{borderColor:"#999999"}},orient:"vertical",feature:{restore:{title:Dynamic.analysis_tools7},saveAsImage:{backgroundColor:"rgba(0,0,0,0)",title:Dynamic.analysis_tools6}}},legend:{orient:"vertical",left:"10%",top:"20%",data:e.map(function(e){return e.name}),textStyle:{color:"#999999"}},series:[{name:title,type:"funnel",left:"10%",top:60,bottom:60,width:"80%",min:0,max:t,minSize:"0%",maxSize:"60%",gap:2,label:{normal:{show:!0,position:"right",formatter:function(t){if(0!=t.dataIndex){var a=toDecimal2(ForDight(100*e[t.dataIndex].value/e[t.dataIndex-1].value,2)),r=toDecimal2(ForDight(100*e[t.dataIndex].value/e[0].value,2));return 0==a&&(a="0"),0==r&&(r="0"),t.name+"\n"+Dynamic.analysis_pageViewNum+"："+t.value+"\n"+Dynamic.analysis_cvr_text1+"："+a+"%\n"+Dynamic.analysis_cvr_text2+"："+r+"%"}return t.name+"\n"+Dynamic.analysis_pageViewNum+"："+t.value}},emphasis:{textStyle:{fontSize:15}}},labelLine:{normal:{length:30,lineStyle:{width:1,type:"solid"}}},itemStyle:{normal:{borderColor:"#999999",borderWidth:1}},data:e}]};funnelChart.setOption(r),addLoadEvent(funnelChart.resize),dataTable_1&&dataTable_1.destroy();var n=$(".cvrBox_line4 table").eq(0);$("tbody tr",n).remove();for(var a=0;a<cvrMoreData.length-1;a++){var o,i=cvrMoreData[a].pvCount;o=0==i?"∞":toDecimal2(ForDight(100*cvrMoreData[a+1].pvCount/cvrMoreData[a].pvCount,2));var l=$("<tr><td>"+(a+1)+"</td><td style='overflow:hidden;text-overflow:ellipsis;white-space:nowrap;'>"+cvrMoreData[a].url+"&nbsp;&nbsp;("+cvrMoreData[a].pvCount+"次)</td><td>"+cvrMoreData[a+1].url+"&nbsp;&nbsp;("+cvrMoreData[a+1].pvCount+"次)</td><td>"+o+"%</td></tr>");$("tbody",n).append(l)}dataTable_1=dataTableInit(n)}function cvrLine(e,t){lineChart=echarts.init(document.getElementsByClassName("echarts_more")[0]);var a=0,r={color:["#67809f","#4b77be","#4c87b9","#5e738b","#5c9bd1"],title:{show:!1,text:Dynamic.analysis_cvr_paginationArr[0],subtext:"areaDemo",left:"center",textStyle:{color:"#999999"}},legend:{left:"13%",top:"3%",data:function(){var t=[];for(var a in e)if("time"!=a){var r={};r.name=a,r.icon="roundRect",t.push(r)}return t}()},tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{color:"#999999"}},formatter:function(e){var t=e[0].name+"<br />"+Dynamic.analysis_ViewNum+"<br />";for(a=0;a<e.length;a++)t+=e[a].seriesName+":"+e[a].value+"<br />";return t}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:e.time.map(function(e){return e}),axisLable:{formatter:function(e,t){var a=new Date(e);return 0===t?e:[a.getMonth()+1,a.getDate()].join("-")}},axisLine:{lineStyle:{color:"#999999"}},solitLine:{show:!1},boundaryGap:!1},yAxis:[{name:Dynamic.analysis_ViewNum,type:"value",scale:{power:1,precision:1},axisLabel:{formatter:"{value}"},axisLine:{lineStyle:{color:"#999999"}},splitNumber:3,splitLine:{show:!1}}],toolbox:{show:!0,right:"10%",top:"15px",iconStyle:{normal:{borderColor:"#999999"},emphasis:{borderColor:"#999999"}},feature:{saveAsImage:{backgroundColor:"rgba(0,0,0,0)",title:Dynamic.analysis_tools6},myTool1:{show:!0,title:Dynamic.analysis_tools8,icon:"image://img/close.png",onclick:function(){$(".echarts_funnel").css({height:"100%"}),$(".echarts_more").css({height:"0%"}),funnelChart.resize(),$(".echarts_more").empty()}}}},dataZoom:[{type:"inside",start:0,end:100,throttle:0}],series:function(){var t=[];for(var a in e)if("time"!=a){var r={name:a,type:"line",areaStyle:{normal:{}},data:e[a].map(function(e){return e})};t.push(r)}return t}()};lineChart.setOption(r),addLoadEvent(lineChart.resize)}function cvrMap(e){lineChart=echarts.init(document.getElementsByClassName("echarts_more")[0]);var t=0,a=[];for(var t in e)a.push(t);var r={title:{show:!1,text:Dynamic.analysis_cvr_paginationArr[0],subtext:"areaDemo",left:"center",textStyle:{color:"#999999"}},color:["#67809f","#4b77be","#4c87b9","#5e738b","#5c9bd1"],legend:{left:"13%",top:"3%",data:function(){var t=[];for(var a in e)if("time"!=a){var r={};r.name=a,r.icon="roundRect",t.push(r)}return t}()},tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{color:"#999999"}},formatter:function(e){var a=e[0].name+"<br />"+Dynamic.analysis_ViewNum+"<br />";for(t=0;t<e.length;t++)a+=e[t].seriesName+":"+e[t].value+"<br />";return a}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:e[a[0]].map(function(e){return e.name}),axisLable:{formatter:function(e,t){var a=new Date(e);return 0===t?e:[a.getMonth()+1,a.getDate()].join("-")}},axisLine:{lineStyle:{color:"#999999"}},solitLine:{show:!1},boundaryGap:!1},yAxis:[{name:Dynamic.analysis_ViewNum,type:"value",scale:{power:1,precision:1},axisLabel:{formatter:"{value}"},axisLine:{lineStyle:{color:"#999999"}},splitNumber:3,splitLine:{show:!1}}],toolbox:{show:!0,right:"10%",top:"15px",iconStyle:{normal:{borderColor:"#999999"},emphasis:{borderColor:"#999999"}},feature:{saveAsImage:{backgroundColor:"rgba(0,0,0,0)",title:Dynamic.analysis_tools6},myTool1:{show:!0,title:Dynamic.analysis_tools8,icon:"image://img/close.png",onclick:function(){$(".echarts_funnel").css({height:"100%"}),$(".echarts_more").css({height:"0%"}),funnelChart.resize(),$(".echarts_more").empty()}}}},dataZoom:[{type:"inside",start:0,end:100,throttle:0}],series:function(){var t=[];for(var a in e)if("time"!=a){var r={name:a,type:"line",areaStyle:{normal:{}},data:e[a].map(function(e){return e.value})};t.push(r)}return t}()};lineChart.setOption(r),addLoadEvent(lineChart.resize)}function cvrBr(e,t){lineChart=echarts.init(document.getElementsByClassName("echarts_more")[0]);var a=0;for(var a in e)for(var r in e[a])"others"==e[a][r].browserType&&(e[a][r].browserType=Dynamic.analysis_br_others),""==e[a][r].browserType&&(e[a][r].browserType=Dynamic.analysis_cvr_othersBr);var n=[];for(var a in e)n.push(a);var o={color:["#67809f","#4b77be","#4c87b9","#5e738b","#5c9bd1"],title:{show:!1,text:Dynamic.analysis_cvr_paginationArr[0],subtext:"areaDemo",left:"center",textStyle:{color:"#999999"}},legend:{left:"13%",top:"3%",data:function(){var t=[];for(var a in e)if("time"!=a){var r={};r.name=a,r.icon="roundRect",t.push(r)}return t}()},tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{color:"#999999"}},formatter:function(e){var t=e[0].name+"<br />"+Dynamic.analysis_ViewNum+"<br />";for(a=0;a<e.length;a++)t+=e[a].seriesName+":"+e[a].value+"<br />";return t}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:e[n[0]].map(function(e){return e.browserType}),axisLable:{formatter:function(e,t){var a=new Date(e);return 0===t?e:[a.getMonth()+1,a.getDate()].join("-")}},axisLine:{lineStyle:{color:"#999999"}},solitLine:{show:!1},boundaryGap:!1},yAxis:[{name:Dynamic.analysis_ViewNum,type:"value",scale:{power:1,precision:1},axisLabel:{formatter:"{value}"},axisLine:{lineStyle:{color:"#999999"}},splitNumber:3,splitLine:{show:!1}}],toolbox:{show:!0,right:"10%",top:"15px",iconStyle:{normal:{borderColor:"#999999"},emphasis:{borderColor:"#999999"}},feature:{saveAsImage:{backgroundColor:"rgba(0,0,0,0)",title:Dynamic.analysis_tools6},myTool1:{show:!0,title:Dynamic.analysis_tools8,icon:"image://img/close.png",onclick:function(){$(".echarts_funnel").css({height:"100%"}),$(".echarts_more").css({height:"0%"}),funnelChart.resize(),$(".echarts_more").empty()}}}},dataZoom:[{type:"inside",start:0,end:100,throttle:0}],series:function(){var t=[];for(var a in e)if("time"!=a){var r={name:a,type:"line",areaStyle:{normal:{}},data:e[a].map(function(e){return e.browserNum})};t.push(r)}return t}()};lineChart.setOption(o),addLoadEvent(lineChart.resize)}function cvrOs(e,t){lineChart=echarts.init(document.getElementsByClassName("echarts_more")[0]);var a=0;for(var a in e)for(var r in e[a])"others"==e[a][r].osType&&(e[a][r].osType=Dynamic.analysis_br_others),""==e[a][r].osType&&(e[a][r].osType=Dynamic.analysis_cvr_othersOs);var n=[];for(var a in e)n.push(a);var o={color:["#67809f","#4b77be","#4c87b9","#5e738b","#5c9bd1"],title:{show:!1,text:Dynamic.analysis_cvr_paginationArr[0],subtext:"areaDemo",left:"center",textStyle:{color:"#999999"}},legend:{left:"13%",top:"3%",data:function(){var t=[];for(var a in e)if("time"!=a){var r={};r.name=a,r.icon="roundRect",t.push(r)}return t}()},tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{color:"#999999"}},formatter:function(e){var t=e[0].name+"<br />"+Dynamic.analysis_ViewNum+"<br />";for(a=0;a<e.length;a++)t+=e[a].seriesName+":"+e[a].value+"<br />";return t}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:e[n[0]].map(function(e){return e.osType}),axisLable:{formatter:function(e,t){var a=new Date(e);return 0===t?e:[a.getMonth()+1,a.getDate()].join("-")}},axisLine:{lineStyle:{color:"#999999"}},solitLine:{show:!1},boundaryGap:!1},yAxis:[{name:Dynamic.analysis_ViewNum,type:"value",scale:{power:1,precision:1},axisLabel:{formatter:"{value}"},axisLine:{lineStyle:{color:"#999999"}},splitNumber:3,splitLine:{show:!1}}],toolbox:{show:!0,right:"10%",top:"15px",iconStyle:{normal:{borderColor:"#999999"},emphasis:{borderColor:"#999999"}},feature:{saveAsImage:{backgroundColor:"rgba(0,0,0,0)",title:Dynamic.analysis_tools6},myTool1:{show:!0,title:Dynamic.analysis_tools8,icon:"image://img/close.png",onclick:function(){$(".echarts_funnel").css({height:"100%"}),$(".echarts_more").css({height:"0%"}),funnelChart.resize(),$(".echarts_more").empty()}}}},dataZoom:[{type:"inside",start:0,end:100,throttle:0}],series:function(){var t=[];for(var a in e)if("time"!=a){var r={name:a,type:"line",areaStyle:{normal:{}},data:e[a].map(function(e){return e.osNum})};t.push(r)}return t}()};lineChart.setOption(o),addLoadEvent(lineChart.resize)}var dataTable_1=!1;