define(["text!/tpl/recycle.html","icheck"],function(e){function t(){$(".page-content").html(e);var t,c=["",Dynamic.manage_type1,Dynamic.manage_type2];$(function(){function e(){$.ajax({async:!0,type:"post",dataType:"json",url:"/api/recycle.open",data:{roleId:roleID},success:function(e){$.each(e,function(e,t){var n="<i class='shou_fang'></i>",i="",a="",s="",r="";if(null==t.filename)n="";else{var l=t.fileid.split(",");1==l.length&&(n="");for(var o=t.filename.split(","),d=t.fileuptime.split(","),p=t.filedeadtime.split(","),u=t.filetype.split(","),f=t.filesize.split(","),h=0;h<o.length;h++)n+="<div class='fen'>"+o[h]+"</div>",i+="<div class='fen'>"+c[u[h]]+"</div>",a+="<div class='fen'>"+d[h]+"</div>",s+="<div class='fen'>"+p[h]+"</div>",r+="<div class='fen'>"+f[h]+"</div>"}var y=$("<tr data-id='"+t.id+"'  class='tr_mid' data-ptn='0'><td class='table-checkbox sorting_disabled'><div class='fen'><input type='checkbox' class='sel'></div></td><td>"+t.delete_time+"</td><td class='p_buttonx td1'><div class='fen' title='"+t.name+"'>"+t.name+"</div></td><td class='p_buttonx td1'><div class='fen' title='"+t.description+"'>"+t.description+"</div></td><td>"+t.create_time+"</td><td class='td1'>"+n+"</td><td class='td1'>"+i+"</td><td class='td1'>"+a+"</td><td class='td1'>"+s+"</td><td class='td1'>"+r+"</td></tr>");$("table").append(y)}),t=$("#rec").DataTable({autoWidth:!1,info:!0,ordering:!1,searching:!0,lengthChange:!0,paging:!0,deferRender:!0,pagingType:"full_numbers",language:Lang}),$('table input[type="checkbox"]').iCheck({checkboxClass:"icheckbox_square-blue",increaseArea:"20%"}),$("tbody").on("ifChecked",".sel",function(){var e=$(this).parents("tr");e.addClass("selected"),$(this).iCheck("check")}),$("tbody").on("ifUnchecked","input.sel",function(){var e=$(this).parents("tr");e.removeClass("selected")}),$("tbody").on("click","tr.tr_mid",function(){$(this).toggleClass("selected"),$(this).find(".sel").iCheck("toggle")});var n=$("tbody input[type='checkbox']").not("input[name='nopro']"),i=$(".allsel");i.on("ifChecked",function(){n.iCheck("check")}),i.on("ifUnchecked",function(){n.iCheck("uncheck")}),$("input[type='search']").attr("class","form-control input-sm input-small input-inline")},error:function(){}})}e(),$("#rec").on("draw.dt",function(){$('table input[type="checkbox"]').iCheck({checkboxClass:"icheckbox_square-blue",increaseArea:"20%"});var e=$("tbody input[type='checkbox']").not("input[name='nopro']"),t=$(".allsel");t.on("ifChecked",function(){e.iCheck("check")}),t.on("ifUnchecked",function(){e.iCheck("uncheck")}),$("#rec_wrapper").width()<1120?$("#rec_wrapper").css("overflow-x","scroll"):$("#rec_wrapper").css("overflow-x","visible")}),$(window).resize(function(){$("#rec_wrapper").width()<1120?$("#rec_wrapper").css("overflow-x","scroll"):$("#rec_wrapper").css("overflow-x","visible")}),changeLanguage("recycle"),$("#restoreChose").click(function(){if(0===$("tr.selected").length)return swal({title:Dynamic.recycle_a6,confirmButtonText:Dynamic.recycle_a2}),!1;var c=[];$("tr.selected").each(function(){c.push($(this).attr("data-id"))}),$.ajax({async:!0,type:"post",url:"/api/recycle.open?cmd=WEL:RECOVERSELECT",data:{ids:c},success:function(c){swal({title:Dynamic.recycle_a1,confirmButtonText:Dynamic.recycle_a2,type:"success"},function(){t.destroy(),$("tbody tr").remove(),e()})},error:function(){swal({title:Dynamic.recycle_a11,confirmButtonText:Dynamic.recycle_a2,type:"error"})}})}),$("#delChose").click(function(){if(0===$("tr.selected").length)return swal({title:Dynamic.recycle_a7,confirmButtonText:Dynamic.recycle_a2}),!1;var c=[];swal({title:Dynamic.recycle_a4,text:Dynamic.recycle_a5,type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:Dynamic.recycle_a8,cancelButtonText:Dynamic.recycle_a3,closeOnConfirm:!1,closeOnCancel:!0,showLoaderOnConfirm:!0},function(){$("tr.selected").each(function(){c.push($(this).attr("data-id"))}),$.ajax({async:!0,type:"post",url:"/api/recycle.open?cmd=WEL:DELETESELECT",data:{ids:c},success:function(c){swal({title:Dynamic.recycle_a9,confirmButtonText:Dynamic.recycle_a2,type:"success"},function(){t.destroy(),$("tbody tr").remove(),e()})},error:function(){swal({title:Dynamic.recycle_a10,confirmButtonText:Dynamic.recycle_a2,type:"error"})}})})}),$("tbody").delegate(".shou_fang","click",function(e){e.stopPropagation();var t=$(this).parents(".tr_mid").find(".td1");0==$(this).parents(".tr_mid").attr("data-ptn")?(t.children("div").show(),$(this).parents(".tr_mid").attr("data-ptn","1"),$(this).css("transform","rotate(180deg)")):(t.children("div").not($(this).children("div").eq(0)).hide(),t.each(function(){$(this).children("div").eq(0).show()}),$(this).parents(".tr_mid").attr("data-ptn","0"),$(this).css("transform","rotate(0deg)"))})})}return{render:t}});