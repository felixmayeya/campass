define(["text!/tpl/check.html","icheck"],function(t){function e(){$(".page-content").html(t),$(function(){$.ajax({async:!1,type:"get",dataType:"json",url:"/api/check.open",success:function(t){$("#dead").html(t.date),$.each(t.combo,function(t){var e="<tr>";$.each(this,function(t){e+="<td>"+this+"</td>"}),e+="</tr>",$(".billtable tbody").append(e)}),$.each(t.bill,function(t){$(".topul2").eq(t).html(this)}),$.each(t.check,function(t,e){var c=$("<tr><td>"+e.payment+"</td><td>"+e.freshTime+'</td><td><a href="javascript:void(0);" style="color:#678098!important">'+Dynamic.check_detail+"</a></td></tr>");$(".check_table tbody").append(c)})}}),$(document).ready(function(){var t=(275-$(".checkhead").height()-$(".check_table thead tr").height())/$(".check_table tbody tr").height();$(".check_table tbody tr").length>t?$(".check_table").css("overflow-y","scroll"):$(".check_table").css("overflow-y","hidden")}),$(window).resize(function(){var t=(275-$(".checkhead").height()-$(".check_table thead tr").height())/$(".check_table tbody tr").height();$(".check_table tbody tr").length>t?$(".check_table").css("overflow-y","scroll"):$(".check_table").css("overflow-y","hidden")}),$(".all_check").click(function(){$(".check_table tbody tr.active").length!=$(".check_table tbody tr").length?$(".check_table tbody tr").addClass("active"):$(".check_table tbody tr").removeClass("active")}),$(".mod2 .portlet-body .small").css("left","0"),changeLanguage("check"),$("#level").click(function(){window.location.href="#/package"}),$(".check_table").delegate("a","click",function(t){t.stopPropagation();var e=$(this).parents("tr").children("td").eq(0).html();$("#dbox").children().not(".dbtop").remove(),$(".mod2").hide(),$(".mod1,.mod3").show(),$("#m_print").show(),$("#billtime").html(e),$.ajax({async:!0,type:"get",dataType:"json",data:e,url:"/api/check.open?cmd=WEL:SELECTPACKAGEBILLDETAIL&bill_date="+e,success:function(t){$.each(t.comp,function(t,e){$(".mod4 p").eq(t).html(e)}),$.each(t.electric_check.table,function(t,e){var c=$(".tbbox>.tablebox").clone(),a="";$.each(this.table,function(t,e){var c='<tr><td class="text-center">'+e.date+'</td><td class="text-center">'+e.newDataCont+'</td><td class="text-center">'+e.accumulative+'</td><td class="text-center">'+e.newOverCont+'</td><td class="text-center">'+e.source+'</td><td class="text-center">'+e.duration+'</td><td class="text-center">'+e.figure+"</td></tr>";a+=c}),c.find("tbody").html(a),c.find(".titlee").html(this.title),$.each(this.bottom,function(t){c.find(".dis2").eq(t).html(this)}),$("#dbox").append(c)}),$("#dbox>.tablebox").show()}})}),$(".check_table").delegate("tr","click",function(){$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active")}),$(".actions a:nth-of-type(2)").click(function(){var t=[];return 0===$(".check_table tr.active").length?(swal({title:Dynamic.check_check,confirmButtonText:Dynamic.manage_sl_apply}),!1):($(".check_table tr.active").each(function(){t.push($(this).children("td").eq(0).html())}),void $.ajax({async:!0,type:"post",dataType:"json",data:{bill_date:t},url:"/api/check.open?cmd=WEL:DOWNLOADBILL",success:function(t){var e={initFileName:t.fileName},c=document.createElement("form");c.action="DownLoadPDF",c.method="post",c.style.display="none";for(var a in e){var n=document.createElement("textarea");n.name=a,n.value=e[a],c.appendChild(n)}return document.body.appendChild(c),c.submit(),c}}))}),$(".actions a:nth-of-type(3)").click(function(){var t=[];if(0===$(".check_table tr.active").length)return swal({title:Dynamic.check_check,confirmButtonText:Dynamic.manage_sl_apply}),!1;$(".check_table tr.active").each(function(){t.push($(this).children("td").eq(0).html())});var e={bill_date:t};$.post("/api/check.open?cmd=WEL:BILLSENDMAIL",e,function(){swal({title:Dynamic.check_send,text:Dynamic.check_back,confirmButtonText:Dynamic.manage_sl_apply,type:"success"})})}),$("#m_print").click(function(){var t=$("#billtime").html();$.ajax({async:!0,type:"post",dataType:"json",url:"/api/check.open?cmd=WEL:PRINTBILLMAIL&bill_date="+t,success:function(e){$("#printIframe").attr("src","data/"+t+".pdf"),setTimeout(function(){$("#printIframe")[0].contentWindow.print(),$.ajax({async:!0,type:"post",dataType:"json",url:"/api/check.open?cmd=WEL:DELETEPRINTPDF&bill_date="+t})},100)}})})})}return{render:e}});