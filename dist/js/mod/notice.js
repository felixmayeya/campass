function getExportFile(t){window.location.href="/api/download.open?cmd=WEL:EXPORTEXCELFROMNOTICE&fileName="+t}define(["text!/tpl/notice.html","pagination"],function(t){function a(){$(".page-content").html(t),changeLanguage("notice");var a=function(t){var t=t,a="";$.each(t,function(t,e){var n=e.status;1==n&&(n='<span class="item-status"><span class="badge badge-empty badge-closed"></span>&nbsp;'+Dynamic.notice_readed+"</span>"),0==n&&(n='<span class="item-status"><span class="badge badge-empty badge-success"></span>&nbsp;'+Dynamic.notice_unread+"</span>"),3==e.type&&(a=a+'<div class="well"><p>'+n+'<a href="#package" class="pull-right font-blue-madison">'+Dynamic.notice_options_UpgradePackage+'</a></p><p class="text-left"> '+e.content+'</p><p class="text-left"> <small>'+e.create_time+"</small> </p></div>"),a=7==e.type?a+'<div class="well"><p>'+n+'<a href=javascript:getExportFile("'+e.file_path+'"); class="pull-right font-blue-madison">'+Dynamic.notice_downloadCSV+'</a></p><p class="text-left"> '+e.content+'</p><p class="text-left"> <small>'+e.create_time+"</small> </p></div>":a+'<div class="well"><p>'+n+'</p><p class="text-left"> '+e.content+' </p><p class="text-left"> <small>'+e.create_time+"</small> </p></div>"}),$(".portlet-body > .notice-list").html(a)},e=function(){$("#all-message").bind("click",function(){$(".portlet-body > .notice-list").empty(),$(".pagination").empty(),n()}),$("#unRead-message").bind("click",function(){$(".portlet-body > .notice-list").empty(),$(".pagination").empty(),n("unRead")}),$("#mark-as-read").bind("click",function(){s()})},n=function(t){var t=t||"all",e="";e="unRead"===t?"/api/notice.open?cmd=WEL:SELECTUNREADNOTICE":"/api/notice.open",$(".pagination").pagination({dataSource:function(t){$.ajax({async:!0,type:"POST",dataType:"json",url:e,data:{user_id:userID},success:function(a){console.log(a);var e=a.list||a,n=a.status;n&&("on"===n?$("#switch-mail").bootstrapSwitch("state",!0):$("#switch-mail").bootstrapSwitch("state",!1)),e&&e.length>0?t(e):$(".portlet-body > .notice-list").html('<p class="text-center">'+Dynamic.notice_nomessages+"</p>")}})},pageSize:5,callback:function(t,e){console.log(e.el[0]);var n=t;a(n)}})},s=function(){$.ajax({async:!0,type:"POST",dataType:"json",url:"/api/notice.open?cmd=WEL:UPDATENOTICE",data:{user_id:userID},success:function(t){$("#all-message").click(),$("#all-message").parent().addClass("active"),$("#unRead-message").parent().removeClass("active"),initMessageInfo(userID)}})};$("#switch-mail").bootstrapSwitch({onText:Dynamic.notice_open,offText:Dynamic.notice_close,onSwitchChange:function(t,a){1==a?$.ajax({async:!0,type:"POST",dataType:"json",url:"/api/notice.open?cmd=WEL:ISRECEIVENOTICE",data:{status:"on"},success:function(t){}}):$.ajax({async:!0,type:"POST",dataType:"json",url:"/api/notice.open?cmd=WEL:ISRECEIVENOTICE",data:{status:"off"},success:function(t){}})}}),n(),e()}return{render:a}});