<!DOCTYPE html>
<!--
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.3.7
Version: 4.7.1
Author: KeenThemes
Website: http://www.keenthemes.com/
Contact: support@keenthemes.com
Follow: www.twitter.com/keenthemes
Dribbble: www.dribbble.com/keenthemes
Like: www.facebook.com/keenthemes
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
Renew Support: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.
-->
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<!-- BEGIN HEAD -->

<head>
	<meta charset="utf-8" />
	<title>CAMPASS朗录</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta content="width=device-width, initial-scale=1" name="viewport" />
	<meta content="Preview page of Metronic Admin Theme #4 for " name="description" />
	<meta content="" name="author" />
	<link href="img/favicon.ico" rel="shortcut icon" />
	<!-- BEGIN GLOBAL MANDATORY STYLES -->
	<link rel="stylesheet" href="css/login-base-bc745317f2.min.css"/>
</head>
<!-- END HEAD -->

<body class=" login">
	<!-- BEGIN : LOGIN PAGE 5-1 -->
	<div class="user-login-5">
		<div class="row bs-reset clearfix">
			<div class="col-md-6 bs-reset mt-login-5-bsfix clearfix">
				<div class="login-bg" style="background-image: url(assets/pages/img/login/bg1.jpg)">
					<img style="width: 200px;" class="login-logo" src="img/campass.png" />
				</div>
			</div>
			<div class="col-md-6 login-container bs-reset mt-login-5-bsfix">
				<select class="selectpickerA pull-right" data-style="btn-info" data-width="100px">
					<option data-lang="zh">简体中文</option>
					<option data-lang="en">English</option>
				</select>
				<div class="login-content" style="margin-bottom: 50px;">
					<h1 data-i18n="string_welcome">欢迎登录</h1>
					<h2 style="color: #4e5a64" data-i18n="string_langlu">朗录·一站式日志智能管理平台</h2>
					<form action="javascript:;" class="login-form" method="post">
						<div class="row">
							<div class="col-xs-6">
								<input placeholder="用户名" class="form-control form-control-solid placeholder-no-fix form-group" type="text" autocomplete="off" name="username" id="username" required />
							</div>
							<div class="col-xs-6">
								<input placeholder="密码" class="form-control form-control-solid placeholder-no-fix form-group" type="password" autocomplete="off" name="password" id="password" required />
							</div>
						</div>
						<div class="row">
							<div class="col-sm-4">
								<div class="rem-password">
									<label class="rememberme mt-checkbox mt-checkbox-outline" style="text-indent: 2em; font-size: 13px;"> <input
										type="checkbox" name="remember" value="1" id="savePassword" />
										<i data-i18n="string_nextlogin">下次自动登录</i> <span></span>
									</label><br />

								</div>
							</div>
							<div class="col-sm-8 text-right">
								<div class="forgot-password">
									<a href="javascript:;" id="forget-password" class="forget-password" data-i18n="string_forget">忘记密码</a>
								</div>
								<button class="btn green ladda-button" name="logIn" id="loginBtn" onclick="saveReport()" data-style="zoom-in">
									<span class="ladda-label" data-i18n="string_signin">登录</span>
								</button>
							</div>
							<div class="col-sm-12">
								<label class="mt-checkbox mt-checkbox-outline" style="text-indent: 2em; font-size: 13px;"> <input
									type="checkbox" id="read" checked="checked" /> <i
									data-i18n="string_read">我已阅读并同意</i> <a href="/static/agreement.html"
									target="_blank" data-i18n="string_agreement">《服务协议》</a> <i
									data-i18n="string_dou">,</i> <a href="/static/license.html"
									target="_blank" data-i18n="string_license">《软件许可》</a> <i
									data-i18n="string_dou">,</i> <a href="/static/privacy.html"
									target="_blank" data-i18n="string_policy">《隐私条款》</a> <span></span>
								</label>
							</div>
						</div>
					</form>
					<!-- BEGIN FORGOT PASSWORD FORM -->
					<form class="forget-form" action="javascript:;" method="post" style="display:none">
						<h3 class="font-green" data-i18n="string_forget"></h3>
						<p data-i18n="string_resetpassword">输入您的邮箱地址来重置密码</p>
						<div class="form-group">
							<input class="form-control placeholder-no-fix form-group" type="text" id="f_username" name="username" placeholder="用户名" />
						</div>
						<div class="form-group">
							<input class="form-control placeholder-no-fix form-group" type="text" id="f_email" name="email" placeholder="邮箱" />
						</div>
						<div class="form-actions">
							<button type="button" id="back-btn" class="btn green btn-outline" data-i18n="string_back">返回</button>
							<button type="button" class="btn btn-success uppercase pull-right" id="retrievePasswordBtn" data-i18n="string_submit">提交</button>
						</div>
					</form>
					<!-- END FORGOT PASSWORD FORM -->
				</div>
				<div class="login-footer">
					<div class="row bs-reset">
						<div class="col-xs-12 bs-reset">
							<div class="login-copyright text-center">
								<p>
									<i data-i18n="string_copy">2016-2017 &copy;</i>&nbsp;<a href="http://www.open01.com" target="_blank" data-i18n="strin_company">北京开数科技有限公司</a>&nbsp;<i data-i18n="string_copyright">版权所有&nbsp;京ICP备16025114号</i><i></i>
									&nbsp;<img src="img/icon-police.png" style="vertical-align: middle;margin-top: -3px;margin-right: 3px;" /><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802023241">京公网安备 11010802023241号</a>
								</p>
								<p>
									<a href="agreement.html" target="_blank" data-i18n="string_agreementQ">服务协议</a>&nbsp;|&nbsp;<a href="license.html" target="_blank" data-i18n="string_licenseQ">软件许可</a>&nbsp;|&nbsp;<a href="privacy.html" target="_blank" data-i18n="string_policyQ">隐私条款</a>
								</p>
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- END : LOGIN PAGE 5-1 -->
	<!--[if lt IE 9]>
	<script src="assets/global/plugins/respond.min.js"></script>
	<script src="assets/global/plugins/excanvas.min.js"></script>
	<script src="assets/global/plugins/ie8.fix.min.js"></script>
	<![endif]-->

	<script src="js/login-lib-f324917f29.min.js"></script>

	<script type="text/javascript">
		var Lang, Dynamic;
		var dynamic_zh = {
			strings_wrongname: "该用户名不存在，请注册!",
			strings_wrongpassword: "密码错误，请重新输入！",
			strings_serverlis: "请确认您已阅读并同意相应服务条款！",
			strings_writename: "请输入用户名",
			strings_writepassword: "请输入密码",
			strings_writeusername: "请填写用户名称！",
			strings_writeemail: "请填写系统用户信息中的邮件信息！",
			strings_notsame: "登录名或邮箱与注册信息不一致，请重新输入！",
			strings_sendsuccess: "发送成功，请登录邮箱进行操作。",
			strings_senderror: "请求失败",
			strings_ok: "确定",
			strings_expire: "账户到期无法使用",
			strings_close: "账号已被关闭无法使用"
		};
		var dynamic_en = {
			strings_wrongname: "The username does not exist",
			strings_wrongpassword: "Password error! Please watch for to distinguish analyse the size to write",
			strings_serverlis: "Please confirm the terms and conditions",
			strings_writename: "Please enter your login username",
			strings_writepassword: "Please enter your login user password",
			strings_writeusername: "Please enter your login username",
			strings_writeemail: "Please enter your login E-mail",
			strings_notsame: "Your username/E-mail combination was not correct. Please try again",
			strings_sendsuccess: "Sent successfully,Please login email.",
			strings_senderror: "Request failed ",
			strings_ok: "OK",
			strings_expire: "Due account cannot be used",
			strings_close: "Account has been closed"
		}
		$(document).ready(function() {
			console.log(navigator.language)
			var local = localStorage.getItem("language");
			if (local == null) {
				navigator.language == "zh-CN" ? Lang = "zh" : Lang = "en";
			} else {
				local == "zh" ? Lang = "zh" : Lang = "en";
			}
			Lang == "zh" ? Dynamic = dynamic_zh : Dynamic = dynamic_en;
			changeLanguage(Lang, 'strings');
			$('.selectpickerA option[data-lang=' + Lang + ']').prop("selected", true);
			$("i").css("font-style", "normal");
			$('.selectpickerA').selectpicker();
			$('.selectpickerA').change(function() {
				Lang = $(this).find("option:selected").attr("data-lang");
				Lang == "zh" ? Dynamic = dynamic_zh : Dynamic = dynamic_en;
				changeLanguage(Lang, 'strings');
			});
			//i18n
			function changeLanguage(lang, pagename) {
				jQuery.i18n.properties({ // 加载资浏览器语言对应的资源文件
					name: pagename, // 资源文件名称
					path: 'i18n/', // 资源文件路径
					mode: 'both', // 用 Map 的方式使用资源文件中的值
					language: lang,
					cache: false,
					encoding: 'UTF-8',
					callback: function() { // 加载成功后设置显示内容
						$("[data-i18n]").each(function() {
							$(this).html($.i18n.prop($(this).attr("data-i18n")));
						});
						$("#username").attr("placeholder", $.i18n.prop("string_username"));
						$("#f_username").attr("placeholder", $.i18n.prop("string_username"));
						$("#password").attr("placeholder", $.i18n.prop("string_password"));
						$("#f_email").attr("placeholder", $.i18n.prop("string_email"));
						localStorage.setItem("language", lang);
					}
				});
				if (Lang == "en") {
					$('a[data-i18n="string_agreementQ"]').attr("href", "/static/agreement_en.html");
					$('a[data-i18n="string_licenseQ"]').attr("href", "/static/license_en.html");
					$('a[data-i18n="string_policyQ"]').attr("href", "/static/privacy_en.html");
					$('a[data-i18n="string_agreement"]').attr("href", "/static/agreement_en.html");
					$('a[data-i18n="string_license"]').attr("href", "/static/license_en.html");
					$('a[data-i18n="string_policy"]').attr("href", "/static/privacy_en.html");
				} else {
					$('a[data-i18n="string_agreementQ"]').attr("href", "/static/agreement.html");
					$('a[data-i18n="string_licenseQ"]').attr("href", "/static/license.html");
					$('a[data-i18n="string_policyQ"]').attr("href", "/static/privacy.html");
					$('a[data-i18n="string_agreement"]').attr("href", "/static/agreement.html");
					$('a[data-i18n="string_license"]').attr("href", "/static/license.html");
					$('a[data-i18n="string_policy"]').attr("href", "/static/privacy.html");
				}
			}
			//禁止浏览器后退
			history.pushState(null, null, document.URL);
			window.addEventListener('popstate', function() {
				history.pushState(null, null, document.URL);
			});
			//清除用户浏览缓存
			localStorage.setItem("PROJECTID", "")
			localStorage.setItem("ANALYSIS_DATE_HTML", "")
			localStorage.setItem("ANALYSIS_START_TIME", "");
			localStorage.setItem("ANALYSIS_END_TIME", "");
			localStorage.setItem("ANALYSIS_INTERVAL", "");
			localStorage.setItem("ANALYSIS_LABLE", "");
			//cookie验证
			if ($.cookie("rmbUser") == "true") {
				$("#savePassword").prop("checked", true);
				$("#username").val($.cookie("user_name"));
				$("#password").val($.cookie("pass_word"));
				$.ajax({
					async: true,
					type: "post",
					//dataType : "json", //返回json格式
					url: "/api/index.open",
					data: {
						username: $('#username').val(),
						password: $('#password').val(),
						language: Lang
					},
					success: function(data) { //请求成功后处理函数。
						if (data == null) {
							swal({
								title: Dynamic.strings_wrongname,
								confirmButtonText: Dynamic.strings_ok,
								closeOnConfirm: true,
								type: "error"
							}, function() {
								l.stop();
							});
							return false;
						} else if (data.statu == 'fail') {
							swal({
								title: Dynamic.strings_wrongpassword,
								confirmButtonText: Dynamic.strings_ok,
								closeOnConfirm: true,
								type: "error"
							}, function() {
								l.stop();
							});
							return false;
						} else if (data.statu == 'expire') {
							swal({
								title: Dynamic.strings_expire,
								confirmButtonText: Dynamic.strings_ok,
								closeOnConfirm: true,
								type: "error"
							}, function() {
								l.stop();
							});
						} else if (data.statu == 'close') {
							swal({
								title: Dynamic.strings_close,
								confirmButtonText: Dynamic.strings_ok,
								closeOnConfirm: true,
								type: "error"
							}, function() {
								l.stop();
							});
						} else {
							window.location.href = "home.html"
						}
					},
					error: function() { //请求失败处理函数
						alert(Dynamic.strings_senderror);
						l.stop();
						return false;
					}
				});
			}
		})
		//回车登录
		$("#password").on(
			"keydown",
			function(event) {
				if (event.which == 13 &&
					$(".forget-form").css("display") == "none") {
					setTimeout(saveReport, 10)
				}
			});
		//登录验证
		function saveReport() {
			var l = Ladda.create(document.getElementById("loginBtn"));
			l.start();
			if (!$("#read").prop("checked")) {
				swal({
					title: Dynamic.strings_serverlis,
					confirmButtonText: Dynamic.strings_ok,
					type: "warning"
				}, function() {
					l.stop();
				});
				return false;
			}

			if ($("#username").val() == "") {
				swal({
					title: Dynamic.strings_writename,
					confirmButtonText: Dynamic.strings_ok,
					closeOnConfirm: true,
					type: "warning"
				}, function() {
					l.stop();
				});
				return false;
			};
			if ($("#password").val() == "") {
				swal({
					title: Dynamic.strings_writepassword,
					confirmButtonText: Dynamic.strings_ok,
					closeOnConfirm: true,
					type: "warning"
				}, function() {
					l.stop();
				});
				return false;
			};
			$.ajax({
				async: true,
				type: "post",
				//dataType : "json", //返回json格式
				url: "/api/index.open",
				data: {
					username: $('#username').val(),
					password: $('#password').val(),
					language: Lang
				},
				success: function(data) { //请求成功后处理函数。
					if (data == null) {
						swal({
							title: Dynamic.strings_wrongname,
							confirmButtonText: Dynamic.strings_ok,
							closeOnConfirm: true,
							type: "error"
						}, function() {
							l.stop();
						});
						return false;
					} else if (data.statu == 'fail') {
						swal({
							title: Dynamic.strings_wrongpassword,
							confirmButtonText: Dynamic.strings_ok,
							closeOnConfirm: true,
							type: "error"
						}, function() {
							l.stop();
						});
						return false;
					} else if (data.statu == 'expire') {
						swal({
							title: Dynamic.strings_expire,
							confirmButtonText: Dynamic.strings_ok,
							closeOnConfirm: true,
							type: "error"
						}, function() {
							l.stop();
						});
					} else if (data.statu == 'close') {
						swal({
							title: Dynamic.strings_close,
							confirmButtonText: Dynamic.strings_ok,
							closeOnConfirm: true,
							type: "error"
						}, function() {
							l.stop();
						});
					} else {
						if ($("#savePassword").prop("checked") == true) {
							var str_username = $("#username").val();
							var str_password = $("#password").val();
							$.cookie("rmbUser", "true", {
								expires: 30
							});
							$.cookie("user_name", str_username, {
								expires: 30
							});
							$.cookie("pass_word", str_password, {
								expires: 30
							});
						} else {
							$.cookie("rmbUser", "false", {
								expire: -1
							});
							$.cookie("user_name", "", {
								expires: -1
							});
							$.cookie("pass_word", "", {
								expires: -1
							});
						}
						localStorage.setItem("ROLE_USER", $('#username').val());
						window.location.href = "home.html"
					}
				},
				error: function() { //请求失败处理函数
					alert(Dynamic.strings_senderror);
					l.stop();
					return false;
				}
			});
		}
		$("#retrievePasswordBtn").click(function() {
			var username = $('#f_username').val();
			var email = $('#f_email').val();
			if ("" == username.trim()) {
				swal({
					title: Dynamic.strings_writeusername,
					confirmButtonText: Dynamic.strings_ok,
					type: "error"
				});
				return;
			}
			if ("" == email.trim()) {
				swal({
					title: Dynamic.strings_writeemail,
					confirmButtonText: Dynamic.strings_ok,
					type: "error"
				});
				return;
			}

			$.ajax({
				type: "post",
				url: "/api/index.open?cmd=WEL:FORGETPASSWORD",
				data: {
					username: username,
					email: email
				},
				async: true,
				success: function(data) {
					if (data == "0") {
						swal({
							title: Dynamic.strings_notsame,
							confirmButtonText: Dynamic.strings_ok,
							type: "error"
						});
					}
					if (data == "1") {
						swal({
							title: Dynamic.strings_sendsuccess,
							confirmButtonText: Dynamic.strings_ok,
							type: "success"
						});
					}
				},
				error: function() { // 请求失败处理函数
					alert(Dynamic.strings_senderror);
				}
			});
		})
	</script>
</body>
<!-- <script type="text/javascript">
var protocol = "https:";
if (window.location.protocol != protocol){
    window.location.href = protocol + window.location.href.substring(window.location.protocol.length);
}
</script>  -->

</html>
